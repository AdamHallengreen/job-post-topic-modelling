schema: '2.0'
stages:
  prepare:
    cmd: python src/job_post_topic_modelling/prepare.py
    deps:
    - path: data/Jobnet.xlsx
      hash: md5
      md5: bf71da0bfc3347dbd28ab5cdbe7474dd
      size: 973498
    - path: src/job_post_topic_modelling/prepare.py
      hash: md5
      md5: 93ef2c651f9b3cce63be19a9ef664981
      size: 7243
    params:
      params.yaml:
        prepare:
          settings:
            nobs: 1000
            batch_size: 50
            threads: 4
            chunk_size: 500
          preprocessing:
            model: da_core_news_lg
            pipeline:
            - tok2vec
            - lemmatizer
            keep_negations: true
          star:
            usestar: 0
    outs:
    - path: data/texts.parquet
      hash: md5
      md5: 49d16c577320b34b30bcdcfcf2e910e9
      size: 129837
  train:
    cmd: python src/job_post_topic_modelling/train.py
    deps:
    - path: data/texts.parquet
      hash: md5
      md5: 49d16c577320b34b30bcdcfcf2e910e9
      size: 129837
    - path: src/job_post_topic_modelling/train.py
      hash: md5
      md5: 1ea11e2563e5c6ace290d9d6f39e1964
      size: 5183
    params:
      params.yaml:
        train:
          n_topics: 20
          embedding_model: all-MiniLM-L6-v2
          random_state: 42
    outs:
    - path: output/bertopic_topics.parquet
      hash: md5
      md5: 44643ab3b1c50050678a99d884bbd2e0
      size: 126927
