schema: '2.0'
stages:
  prepare:
    cmd: python src/job_post_topic_modelling/prepare.py
    deps:
    - path: data/Jobnet.xlsx
      hash: md5
      md5: 26964e5ea3bf422d0f744b6fab9af448
      size: 13307578
    - path: src/job_post_topic_modelling/prepare.py
      hash: md5
      md5: 74b89c4b59cc34d96fbd3c4483e6cb7d
      size: 7950
    - path: src/job_post_topic_modelling/utils/data_io.py
      hash: md5
      md5: 59ef5c1e1003183f28c24d1ead36e826
      size: 981
    - path: src/job_post_topic_modelling/utils/find_project_root.py
      hash: md5
      md5: 3e76b8271d64cd468a3e8e0da2fde4e3
      size: 3492
    params:
      params.yaml:
        prepare:
          settings:
            nobs: 1000
          star:
            usestar: 0
    outs:
    - path: data/texts.parquet
      hash: md5
      md5: 3dfe61ed4a9bf0128eb9c71bc4944fc6
      size: 878221
  train:
    cmd: python src/job_post_topic_modelling/train.py
    deps:
    - path: data/texts.parquet
      hash: md5
      md5: d11cc60341eaee7b126cda43e4d56b48
      size: 125177
    - path: src/job_post_topic_modelling/train.py
      hash: md5
      md5: aad65696f54b551359bc764aac233162
      size: 5390
    params:
      params.yaml:
        train:
          n_topics: 20
          embedding_model: all-MiniLM-L6-v2
          random_state: 42
    outs:
    - path: output/bertopic_topics.parquet
      hash: md5
      md5: 493115d7c7e346603ce8ebf9102a1d53
      size: 122877
  predict:
    cmd: python src/job_post_topic_modelling/predict.py
    deps:
    - path: data/embeddings.npy
      hash: md5
      md5: 55e82b008a4989bf77b93e8a5793202e
      size: 3915904
    - path: data/texts.parquet
      hash: md5
      md5: 3dfe61ed4a9bf0128eb9c71bc4944fc6
      size: 878221
    - path: src/job_post_topic_modelling/predict.py
      hash: md5
      md5: eb62badb9eea376cb5ee925a1a0e075d
      size: 6076
    - path: src/job_post_topic_modelling/utils/data_io.py
      hash: md5
      md5: 59ef5c1e1003183f28c24d1ead36e826
      size: 981
    - path: src/job_post_topic_modelling/utils/find_project_root.py
      hash: md5
      md5: 3e76b8271d64cd468a3e8e0da2fde4e3
      size: 3492
    params:
      params.yaml:
        embed:
          embedding_model: intfloat/multilingual-e5-large-instruct
        predict:
          top_n_words: 20
          verbose: true
          dimensionality_reduction:
            model: UMAP
          clustering:
            model: HDBSCAN
          vectorizer:
            model: CountVectorizer
          c_TF_IDF:
            model: c_TF_IDF
          representation:
            model: KeyBERTInspired
    outs:
    - path: models/bertopic_model/config.json
      hash: md5
      md5: 8a0e79a5488a615175aa10b4690ea527
      size: 376
    - path: models/bertopic_model/topic_embeddings.safetensors
      hash: md5
      md5: 5d8c4a8d9b1ff86d7516af21e5dd238e
      size: 204888
    - path: models/bertopic_model/topics.json
      hash: md5
      md5: 9c163703e2fab982329c537e67f66ecf
      size: 52306
  evaluate:
    cmd: python src/job_post_topic_modelling/evaluate.py
    deps:
    - path: models/bertopic_model
      hash: md5
      md5: c717d87b198e5aa727ec2395ad1ad4a6.dir
      size: 257671
      nfiles: 4
    - path: src/job_post_topic_modelling/evaluate.py
      hash: md5
      md5: 11cbbb8ae0bc5f733831d37bf539eb6b
      size: 3472
    - path: src/job_post_topic_modelling/utils/data_io.py
      hash: md5
      md5: 59ef5c1e1003183f28c24d1ead36e826
      size: 981
    - path: src/job_post_topic_modelling/utils/find_project_root.py
      hash: md5
      md5: 3e76b8271d64cd468a3e8e0da2fde4e3
      size: 3492
    - path: src/job_post_topic_modelling/utils/log_html.py
      hash: md5
      md5: d9d99bdd47811925a943a81af29fe3db
      size: 545
    outs:
    - path: output/topic_info.csv
      hash: md5
      md5: 7637e7bbcb42656e3f364075ab001798
      size: 10451
  embed:
    cmd: python src/job_post_topic_modelling/embed.py
    deps:
    - path: data/texts.parquet
      hash: md5
      md5: 3dfe61ed4a9bf0128eb9c71bc4944fc6
      size: 878221
    - path: src/job_post_topic_modelling/embed.py
      hash: md5
      md5: 0b1685cfc695e0857d4e3f74b51bca99
      size: 1180
    - path: src/job_post_topic_modelling/utils/data_io.py
      hash: md5
      md5: 59ef5c1e1003183f28c24d1ead36e826
      size: 981
    - path: src/job_post_topic_modelling/utils/find_project_root.py
      hash: md5
      md5: 3e76b8271d64cd468a3e8e0da2fde4e3
      size: 3492
    params:
      params.yaml:
        embed:
          embedding_model: intfloat/multilingual-e5-large-instruct
    outs:
    - path: data/embeddings.npy
      hash: md5
      md5: 55e82b008a4989bf77b93e8a5793202e
      size: 3915904
